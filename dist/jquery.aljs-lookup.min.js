if("undefined"==typeof jQuery.aljs)throw new Error("Please include the ALJS initializer file");!function(s){var e='<div class="slds-pill-container slds-hide"></div>',t='<span class="slds-pill slds-pill--bare"><a href="#" class="slds-pill__label"><svg aria-hidden="true" class="slds-icon slds-icon-standard-account slds-icon--small"><use xlink:href="{{objectIconUrl}}"></use></svg>{{selectedResultLabel}}</a><button class="slds-button slds-button--icon-bare"><svg aria-hidden="true" class="slds-button__icon"><use xlink:href="{{assetsLocation}}/assets/icons/utility-sprite/svg/symbols.svg#close"></use></svg><span class="slds-assistive-text">Remove</span></button></span>',l='<div class="slds-lookup__menu" role="listbox"><ul class="slds-lookup__list" role="presentation"></ul></div>',i='<div class="slds-lookup__item"><button class="slds-button"><svg aria-hidden="true" class="slds-icon slds-icon-text-default slds-icon--small"><use xlink:href="{{assetsLocation}}/assets/icons/utility-sprite/svg/symbols.svg#search"></use></svg>&quot;{{searchTerm}}&quot; in {{objectPluralLabel}}</button></div>',a='<div class="slds-lookup__item"><button class="slds-button"><svg aria-hidden="true" class="slds-icon slds-icon-text-default slds-icon--small"><use xlink:href="{{assetsLocation}}/assets/icons/utility-sprite/svg/symbols.svg#add"></use></svg>Add {{objectLabel}}</button></div>',n='<li class="slds-lookup__item"><a id="{{resultId}}" href="#" role="option"><svg aria-hidden="true" class="slds-icon slds-icon-standard-account slds-icon--small"><use xlink:href="{{objectIconUrl}}"></use></svg>{{resultLabel}}</a></li>',o=function(t,l){this.$el=s(t),this.$lookupContainer=this.$el.closest(".slds-lookup"),this.settings=l,this.$singleSelect=s(e).insertBefore(this.$el),this.isStringEmpty(l.searchTerm)?l.initialSelectedResult&&(this.updateSingleSelect(l.initialSelectedResult.label),this.$singleSelect.addClass("slds-show").removeClass("slds-hide"),this.$el.closest(".slds-lookup").addClass("slds-has-selection")):(this.$el.val(l.searchTerm),this.updateSingleSelect()),this.initLookup()};o.prototype={constructor:o,isStringEmpty:function(s){return null===s||"undefined"==typeof s||""===s.trim()},initLookup:function(){this.$el.on("focus",this,this.runSearch).on("keyup",this,this.runSearch).on("blur",this,this.handleBlur)},runSearch:function(s){var e=s.data,t=e.$el.val();e.isStringEmpty(t)?e.getDefaultResults():e.getSearchTermResults(t)},updateSingleSelect:function(s){var e=s||"";this.$singleSelect.html(t.replace("{{objectIconUrl}}",this.settings.objectIconUrl).replace("{{assetsLocation}}",this.settings.assetsLocation).replace("{{selectedResultLabel}}",e))},getSearchTermResults:function(s){var e=this;if(this.settings.items.length>0)this.searchResults=this.settings.items.filter(function(e){return null!==e.label.match(s)}),this.renderSearchResults();else{var t=function(s){e.searchResults=s,e.renderSearchResults()};this.settings.filledSearchTermQuery(s,t)}},getDefaultResults:function(){var s=this;if(this.settings.items.length>0)this.searchResults=this.settings.items,this.renderSearchResults();else{var e=function(e){s.searchResults=e,s.renderSearchResults()};this.settings.emptySearchTermQuery(e)}},renderSearchResults:function(){this.closeSearchDropdown();var e=s(l),t=e.find("ul.slds-lookup__list"),o=this.$el.val(),c=this;if(!this.isStringEmpty(o)&&o.length>1&&t.before(i.replace("{{searchTerm}}",o).replace("{{objectPluralLabel}}",this.settings.objectPluralLabel).replace("{{assetsLocation}}",s.aljs.assetsLocation)),this.searchResults.forEach(function(s){t.append(n.replace("{{resultLabel}}",s.label).replace("{{resultId}}",s.id).replace("{{objectIconUrl}}",c.settings.objectIconUrl))}),this.settings.clickAddFunction){t.after(a.replace("{{objectLabel}}",this.settings.objectLabel).replace("{{assetsLocation}}",s.aljs.assetsLocation))}t.on("click","a",this,this.clickResult),this.$lookupSearchContainer=e,e.appendTo(this.$lookupContainer)},closeSearchDropdown:function(){this.$lookupSearchContainer&&(this.$lookupSearchContainer.remove(),this.$lookupSearchContainer=null)},handleBlur:function(e){var t=e.data;0===s(e.relatedTarget).closest(".slds-lookup__menu").length&&t.$lookupSearchContainer&&t.closeSearchDropdown()},clickResult:function(e){var t=e.data,l=s(this).attr("id");t.selectResult(l)},selectResult:function(s){var e=this.searchResults.filter(function(e){return e.id==s});this.selectedResult=e.length>0?e[0]:null,this.closeSearchDropdown(),this.updateSingleSelect(this.selectedResult.label),this.$singleSelect.addClass("slds-show").removeClass("slds-hide"),this.$el.val(this.selectedResult.label).addClass("slds-hide"),this.$el.closest(".slds-lookup").addClass("slds-has-selection")}},s.fn.lookup=function(e){var t,l=arguments,i=s.extend({assetsLocation:s.aljs.assetsLocation,objectPluralLabel:"Stuffs",objectLabel:"Stuff",objectIconUrl:"assets/icons/standard-sprite/svg/symbols.svg#account",searchTerm:"",items:[],emptySearchTermQuery:function(){callback([])},filledSearchTermQuery:function(s,e){e([])},clickAddFunction:null},"object"==typeof e?e:{});if(this.each(function(){var a=s(this),n=a.data("aljs-lookup");if(!n){var c=new o(this,i);a.data("aljs-lookup",n=c)}"string"==typeof e&&(t=n[e](l[1],l[2]))}),void 0===t||t instanceof Picklist)return this;if(this.length>1)throw new Error("Using only allowed for the collection of a single element ("+option+" function)");return t}}(jQuery);